data = glass,
control = rpart.control(cp = 0.0,
minsplit = 2))
plot(rpartFull)
plotcp(rpartFull)
# Fit tree with pruning value
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.027,
minsplit = 2))
plot(rpartFull)
# first leaf has 62 1's second leaf has 18 2's
text(rpartFull, use.n=TRUE)
# Remove glass type 5, since I there are only 9 of them in the dataset
glass$GlassType <- as.numeric(as.character(glassType))
set.seed(1523)
glass <- read.csv('Glass.csv')
glass$GlassType <- as.factor(glass$GlassType)
form <- as.formula(paste0('GlassType ~ ', paste(names(glass)[1:(length(names(glass)) - 1)], collapse = '+')))
# Find the cp value to prune the tree
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.0,
minsplit = 2))
plot(rpartFull)
plotcp(rpartFull)
# Fit tree with pruning value
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.027,
minsplit = 2))
plot(rpartFull)
# first leaf has 62 1's second leaf has 18 2's
text(rpartFull, use.n=TRUE)
# Remove glass type 5, since I there are only 9 of them in the dataset
glass$GlassType <- as.numeric(as.character(GlassType))
set.seed(1523)
glass <- read.csv('Glass.csv')
glass$GlassType <- as.factor(glass$GlassType)
form <- as.formula(paste0('GlassType ~ ', paste(names(glass)[1:(length(names(glass)) - 1)], collapse = '+')))
# Find the cp value to prune the tree
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.0,
minsplit = 2))
plot(rpartFull)
plotcp(rpartFull)
# Fit tree with pruning value
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.027,
minsplit = 2))
plot(rpartFull)
# first leaf has 62 1's second leaf has 18 2's
text(rpartFull, use.n=TRUE)
# Remove glass type 5, since I there are only 9 of them in the dataset
glass$GlassType <- as.numeric(as.character(GlassType))
set.seed(1523)
glass <- read.csv('Glass.csv')
glass$GlassType <- as.factor(glass$GlassType)
form <- as.formula(paste0('GlassType ~ ', paste(names(glass)[1:(length(names(glass)) - 1)], collapse = '+')))
# Find the cp value to prune the tree
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.0,
minsplit = 2))
plot(rpartFull)
plotcp(rpartFull)
# Fit tree with pruning value
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.027,
minsplit = 2))
plot(rpartFull)
# first leaf has 62 1's second leaf has 18 2's
text(rpartFull, use.n=TRUE)
# Remove glass type 5, since I there are only 9 of them in the dataset
glass$GlassType <- as.numeric(as.character(glass$GlassType))
glass <- glass %>% filter(GlassType != 5)
glass$GlassType <- as.factor(glass$GlassType)
table(glass$GlassType)
glass.xval=rep(0,nrow(glass))
xvs=rep(1:10,length=nrow(glass))
xvs=sample(xvs)
for(i in 1:10){
test=glass[xvs==i,]
train=glass[xvs!=i,]
glub=rpart(form,
control=rpart.control(cp=0.046, minsplit=2),
data=train)
print(glub)
glass.xval[xvs==i] = predict(glub,test,type="class")
}
table(glass$GlassType, glass.xval)
set.seed(1523)
glass <- read.csv('Glass.csv')
glass$GlassType <- as.factor(glass$GlassType)
form <- as.formula(paste0('GlassType ~ ', paste(names(glass)[1:(length(names(glass)) - 1)], collapse = '+')))
# Find the cp value to prune the tree
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.0,
minsplit = 2))
plot(rpartFull)
plotcp(rpartFull)
# Fit tree with pruning value
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.027,
minsplit = 2))
plot(rpartFull)
# first leaf has 62 1's second leaf has 18 2's
text(rpartFull, use.n=TRUE)
# Remove glass type 5, since I there are only 9 of them in the dataset
glass$GlassType <- as.numeric(as.character(glass$GlassType))
glass <- glass %>% filter(GlassType != 5)
glass$GlassType <- as.factor(glass$GlassType)
glass.xval=rep(0,nrow(glass))
xvs=rep(1:10,length=nrow(glass))
xvs=sample(xvs)
for(i in 1:10){
test=glass[xvs==i,]
train=glass[xvs!=i,]
glub=rpart(form,
control=rpart.control(cp=0.027, minsplit=2),
data=train)
glass.xval[xvs==i] = predict(glub,test,type="class")
}
table(glass$GlassType, glass.xval)
set.seed(1523)
glass <- read.csv('Glass.csv')
glass$GlassType <- as.factor(glass$GlassType)
form <- as.formula(paste0('GlassType ~ ', paste(names(glass)[1:(length(names(glass)) - 1)], collapse = '+')))
# Find the cp value to prune the tree
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.0,
minsplit = 2))
plot(rpartFull)
plotcp(rpartFull)
# Fit tree with pruning value
rpartFull <- rpart(form , method = 'class',
data = glass,
control = rpart.control(cp = 0.027,
minsplit = 2))
plot(rpartFull)
# first leaf has 62 1's second leaf has 18 2's
text(rpartFull, use.n=TRUE)
# Remove glass type 5, since I there are only 9 of them in the dataset
# glass$GlassType <- as.numeric(as.character(glass$GlassType))
# glass <- glass %>% filter(GlassType != 5)
# glass$GlassType <- as.factor(glass$GlassType)
glass.xval=rep(0,nrow(glass))
xvs=rep(1:10,length=nrow(glass))
xvs=sample(xvs)
for(i in 1:10){
test=glass[xvs==i,]
train=glass[xvs!=i,]
glub=rpart(form,
control=rpart.control(cp=0.027, minsplit=2),
data=train)
glass.xval[xvs==i] = predict(glub,test,type="class")
}
table(glass$GlassType, glass.xval)
library(randomForest)
randomForest(form)
randomForest(form, data = glass)
class(glass$GlassType)
glass.rf <- randomForest(form, data = glass)
View(glass.rf)
glass.rf$oob.times
glass.rf$confusion
glass.rf <- randomForest(form, data = glass)
glass.rf$confusion
glass.rf <- randomForest(form, data = glass)
glass.rf$confusion
?randomForest
varImpPlot(glass.rf)
length(names(glass))
?partialPlot
dim(glass)
names(glass)[-10]
par(mfrow = c(3, 3))
for (name in names(glass)[-10]){
partialPlot(glass.rf, glass, name, class = 1)
}
?importance
importance(glass.rf)
seq_along
?seq_along
imp <- importance(ozone.rf)
imp <- importance(glass.rf)
impvar <- rownames(imp)[order(imp[, 1], decreasing=TRUE)]
seq_along(impvar)
par(mfrow = c(3, 3))
for (name in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[name], class = 1)
}
par(mfrow = c(3, 3))
for (name in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[name], 1)
}
for (i in seq_along(impvar)){
par(mfrow = c(3, 3))
for (name in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[name], impvar[i])
}
}
?partialPlot
par(mfrow = c(3, 3))
for (i in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[i], which.class = 1,
xlab = impvar[i],
main = paste0('partial dep on ', impvar[i]))
}
par(mfrow = c(3, 3))
for (i in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[i], which.class = 1,
xlab = impvar[i],
main = paste0('partial dep on ', impvar[i]),
ylim = c(0, 12))
}
for (i in seq_along(impvar)){
par(mfrow = c(3, 3))
for (j in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[j], which.class = i,
xlab = impvar[i],
main = paste0('partial dep on ', impvar[j]),
ylim = c(0, 12))
}
}
for (i in 1:6){
par(mfrow = c(3, 3))
for (j in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[j], which.class = i,
xlab = impvar[i],
main = paste0('partial dep on ', impvar[j]),
ylim = c(0, 12))
}
}
?mtext
for (j in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[j], which.class = i,
xlab = impvar[i],
main = paste0('partial dep on ', impvar[j]),
ylim = c(0, 12))
}
mtext("My 'Title' in a strange place", side = 3, line = -2, outer = TRUE)
par(mfrow = c(3, 3))
for (j in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[j], which.class = i,
xlab = paste0('partial dep on ', impvar[j]),
ylim = c(0, 12))
}
mtext(paste0('Class Variable ',i), side = 3, line = -1, outer = TRUE)
for (i in 1:6){
par(mfrow = c(3, 3))
for (j in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[j], which.class = i,
xlab = paste0('partial dep on ', impvar[j]),
ylim = c(0, 12))
}
mtext(paste0('Class Variable ',i), side = 3, line = -1, outer = TRUE)
}
for (i in 1:6){
par(mfrow = c(3, 3))
for (j in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[j], which.class = i,
xlab = paste0('partial dep on ', impvar[j]),
ylim = c(0, 12))
}
mtext(paste0('Glass ',i), side = 3, line = -1, outer = TRUE)
}
for (i in 1:6){
par(mfrow = c(3, 3))
for (j in seq_along(impvar)){
partialPlot(glass.rf, glass, impvar[j], which.class = i,
xlab = paste0('partial dep on ', impvar[j]),
ylim = c(0, 12),
main = '')
}
mtext(paste0('Glass ',i), side = 3, line = -1, outer = TRUE)
}
varImpPlot(glass.rf)
set.seed(1234)
glass.rf <- randomForest(form, data = glass)
glass.rf$confusion
varImpPlot(glass.rf)
names(glass)
# Form the variable importance plot we can see iron is probably not important in the model, but this is the only
# variable that seems to be apart from the rest of them.
form <- as.formula(paste0('GlassType ~ ', paste(names(glass)[1:(length(names(glass)) - 2)], collapse = '+')))
form
randomForest(form2, data = glass)
form2 <- as.formula(paste0('GlassType ~ ', paste(names(glass)[1:(length(names(glass)) - 2)], collapse = '+')))
randomForest(form2, data = glass)
glass.rf2 <- randomForest(form2, data = glass)
glass.rf2$confusion
oob.prob <- function(n){
((n-1) / n)^n
}
for (x in seq(1, 1000000, 10000)){
oob.prob(x)
}
oob.prob <- function(n){
((n-1) / n)^n
}
for (x in seq(1, 1000000, 10000)){
oob.prob(x)
}
for (x in seq(1, 1000000, 10000)){
print(oob.prob(x))
}
oobProb <- function(n){
((n-1) / n)^n
}
for (x in 1:seq(1, 1000000, 10000)){
oobProb(x)
}
?seq
for (x in 1:seq(1, 1000000, 1000)){
oobProb(x)
}
for (x in 1:seq(1, 1000000, 1000)){
print(oobProb(x))
}
seq(1, 1000000, 1000)
for (x in seq(1, 1000000, 1000)){
oobProb(x)
}
for (x in seq(1, 1000000, 1000)){
oobProb(x)
}
oobProb <- function(n){
((n-1) / n)^n
}
for(x in seq(1, 1000000, 1000)){
print(oobProb(x))
}
for(x in seq(1, 1000000, seq(1, 10000, 100))){
print(oobProb(x))
}
for(x in seq(1, 1000000, 10000)){
print(oobProb(x))
}
for(x in c(1, 10, 100, 1000, 10000, 100000){
for(x in c(1, 10, 100, 1000, 10000, 100000)){
print(oobProb(x))
}
for(x in c(1, 10, 100, 1000, 10000, 100000, 1000000)){
print(oobProb(x))
}
for(x in c(1, 10, 100, 1000, 10000, 100000, 1000000)){
print(paste0('f(',x,') = ',oobProb(x)))
}
for(x in c(1, 10, 100, 1000, 10000, 100000, 1000000)){
print(paste0('f(',x,') = ',round(oobProb(x)), 2))
}
?round
for(x in c(1, 10, 100, 1000, 10000, 100000, 1000000)){
print(paste0('f(',x,') = ',round(oobProb(x), 2)))
}
for(x in c(1, 10, 100, 1000, 10000, 100000, 1000000)){
print(paste0('f(',x,') = ',round(oobProb(x), 4)))
}
library(knitr)
library(knitr)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning=FALSE)
nest <- read.csv('Nest.csv')
nest$Nest <- as.factor(nest$Nest)
form <- as.formula(paste0('Nest ~ ', paste(names(nest)[3:(length(names(nest)) - 1)], collapse = '+')))
nest.rpartFull <- rpart(form , method = 'class',
data = nest,
control = rpart.control(cp = 0.0,
minsplit = 2))
# plot(nest.rpartFull,margin=0.1)
plotcp(nest.rpartFull)
printcp(nest.rpartFull)
nest.xval=rep(0,nrow(nest))
xvs=rep(1:10,length=nrow(nest))
xvs=sample(xvs)
for(i in 1:10){
test=nest[xvs==i,]
train=nest[xvs!=i,]
glub=rpart(form,
control=rpart.control(cp=0.021, minsplit=2),
data=train)
nest.xval[xvs==i] = predict(glub,test,type="class")
}
table(nest$Nest, nest.xval)
class.sum(as.numeric(as.character(nest$Nest)),
as.numeric(as.character(nest.xval)))
H1B_1 <- read.csv('./Project_2/H1B_Data/File 1 - H1B Dataset.csv')
setwd("C:/Users/camer/SchoolStuff/Spring_2018/Capstone/Data_Analytics_Capstone/Project_2")
H1B_1 <- read.csv('./Project_2/H1B_Data/File 1 - H1B Dataset.csv')
getwd()
H1B_1 <- read.csv('./H1B_Data/File 1 - H1B Dataset.csv')
names(H1B_1)
H1B_1[1, ]
names(H1B_1)
lapply(H1B_1, class)
head(H1B_1)
h1b_2 <- read.csv('./H1B_1')
system2('dir')
system2(dir)
getwd()
h1b_2 <- read.csv('./H1B_1.csv')
dim(h1b_2)
dim(H1B_1)
library(knitr)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning=FALSE)
library(dplyr)
library(rpart)
library(stat5810tools)
set.seed(52)
nest <- read.csv('Nest.csv')
names(nest)
form <- as.formula(paste0('Nest ~ ', paste(names(nest)[3:length(names(nest))], collapse = '+')))
nest.rpartFull <- rpart(form , method = 'class',
data = nest,
control = rpart.control(cp = 0.0,
minsplit = 2))
# plot(nest.rpartFull,margin=0.1)
plotcp(nest.rpartFull)
nest.rpartFull <- rpart(form , method = 'class',
data = nest,
control = rpart.control(cp = 0.021,
minsplit = 2))
plot(nest.rpartFull, margin=0.1)
text(nest.rpartFull, use.n=TRUE)
nest.xval=rep(0,nrow(nest))
xvs=rep(1:10,length=nrow(nest))
xvs=sample(xvs)
for(i in 1:10){
test=nest[xvs==i,]
train=nest[xvs!=i,]
glub=rpart(form,
control=rpart.control(cp=0.021, minsplit=2),
data=train)
nest.xval[xvs==i] = predict(glub,test,type="class")
}
nest.xval=rep(0,nrow(nest))
xvs=rep(1:10,length=nrow(nest))
xvs=sample(xvs)
for(i in 1:10){
test=nest[xvs==i,]
train=nest[xvs!=i,]
glub=rpart(form,
control=rpart.control(cp=0.021, minsplit=2),
data=train)
nest.xval[xvs==i] = predict(glub,test,type="class")
}
for(i in 1:10){
test=nest[xvs==i,]
train=nest[xvs!=i,]
glub=rpart(form,
control=rpart.control(cp=0.021, minsplit=2),
data=train)
nest.xval[xvs==i] = predict(glub,test)
}
kable(table(nest$Nest, nest.xval))
kable(class.sum(as.numeric(as.character(nest$Nest)),
as.numeric(as.character(nest.xval))))
?predict
nest <- read.csv('Nest.csv')
nest$Nest <- as.factor(nest$Nest)
form <- as.formula(paste0('Nest ~ ', paste(names(nest)[3:length(names(nest))], collapse = '+')))
class(nest$StandType)
class(nest$Nest)
nest$StandType <- as.factor(nest$StandType)
form <- as.formula(paste0('Nest ~ ', paste(names(nest)[3:length(names(nest))], collapse = '+')))
nest.rpartFull <- rpart(form , method = 'class',
data = nest,
control = rpart.control(cp = 0.0,
minsplit = 2))
# plot(nest.rpartFull,margin=0.1)
plotcp(nest.rpartFull)
nest.rpartFull <- rpart(form , method = 'class',
data = nest,
control = rpart.control(cp = 0.021,
minsplit = 2))
plot(nest.rpartFull, margin=0.1)
text(nest.rpartFull, use.n=TRUE)
nest.xval=rep(0,nrow(nest))
xvs=rep(1:10,length=nrow(nest))
xvs=sample(xvs)
for(i in 1:10){
test=nest[xvs==i,]
train=nest[xvs!=i,]
glub=rpart(form,
control=rpart.control(cp=0.021, minsplit=2),
data=train)
nest.xval[xvs==i] = predict(glub,test, type = 'class')
}
kable(table(nest$Nest, nest.xval))
kable(class.sum(as.numeric(as.character(nest$Nest)),
as.numeric(as.character(nest.xval))))
nest.xval=rep(0,nrow(nest))
xvs=rep(1:10,length=nrow(nest))
xvs=sample(xvs)
for(i in 1:10){
test=nest[xvs==i,]
train=nest[xvs!=i,]
glub=rpart(form,
control=rpart.control(cp=0.021, minsplit=2),
data=train)
nest.xval[xvs==i] = predict(glub,test, type = 'class')
}
table(nest$Nest, nest.xval
)
class.sum(as.numeric(as.character(nest$Nest)),
as.numeric(as.character(nest.xval)))
